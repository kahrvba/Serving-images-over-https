<h2 id="headline" class="headline">
  <span class="static">What's Next For U? Find Your Best Fit</span>
  <span class="flip" aria-live="polite">
    <div class="line-container"></div>
  </span>
</h2>

<style>
  :root{
    --flip-color:#5FCD78;
    --flip-out:350ms;
    --flip-in:350ms;
    --gap:6px;            /* space between sentence and flip box */
  }

  /* Make the heading control alignment */
  .headline{
    font-family: "Alegreya Sans", Arial, sans-serif;
    font-size: 40px;
    font-weight: 700;
    margin: 0;
    display: flex;                 /* key: flex container */
    justify-content: center;       /* keep the whole thing centered */
    align-items: baseline;         /* align both parts on the text baseline */
    gap: var(--gap);
    line-height: 1.2;              /* your heading line-height */
    text-align: center;            /* harmless with flex */
    position: relative;            /* for absolute positioning of line */
  }
  .headline .static{ font: inherit; line-height: inherit; }

  /* Flip box: fixed width (set by JS), center-anchored content */
  .flip{
    display: inline-grid;
    grid-template-rows: 1em;
    grid-template-columns: 1fr;
    justify-items: center;        /* center align inside the box */
    align-items: end;
    position: relative;
    color: var(--flip-color);
    perspective: 800px;
    font-family: "Handlee", cursive; /* use Handlee font for flip words */
    line-height: 1em;              /* single text line tall */
    transform: translateY(10px);    /* move the flip container down more */
    /* width set by JS; extra space lives on the RIGHT */
  }

  .flip .word{
    grid-row:1; grid-column:1;     /* overlay in same cell */
    position: absolute; left: 0; top: 0;
    backface-visibility: hidden;
    white-space: nowrap;
    font: inherit; line-height: 1em;
    transform: translateY(var(--y,0)) rotateX(var(--rx,0deg));
    will-change: transform;
  }

  /* No fade, sequential flip */
  .flip .word.out { animation: flipOutUp var(--flip-out) ease-in forwards; }
  .flip .word.in  { animation: flipInUp  var(--flip-in)  ease-out forwards; }

  @keyframes flipOutUp {
    0%   { transform: translateY(var(--y,0)) rotateX(0deg);   }
    100% { transform: translateY(var(--y,0)) rotateX(-90deg); }
  }
  @keyframes flipInUp {
    0%   { transform: translateY(var(--y,0)) rotateX(90deg);  }
    100% { transform: translateY(var(--y,0)) rotateX(0deg);   }
  }

  /* Line container styling */
  .line-container {
    position: absolute;
    top: 120%;
    left: 30%;
    transform: translateX(-50%);
    width: 300px;
    height: 17px;
    background: url('/images/line.png') no-repeat center;
    background-size: contain;
    z-index: 1;
  }

  .line-image {
    max-width: 100%;
    height: auto;
  }
</style>

<script>
(function(){
  const words = ["Career","College","University"]; // edit
  const interval = 2000, outMs = 350, inMs = 350;

  function initFlip(){
    const flip = document.querySelector(".flip");
    if (!flip) return;

    // Measure widest/tallest word using heading metrics
    const host = document.getElementById("headline");
    const cs = getComputedStyle(host);
    const measurer = document.createElement("span");
    Object.assign(measurer.style, {
      position:"absolute", visibility:"hidden", whiteSpace:"nowrap",
      fontFamily: cs.fontFamily, fontSize: cs.fontSize, fontWeight: cs.fontWeight,
      lineHeight: "1em"
    });
    document.body.appendChild(measurer);

    let maxW = 0, maxH = 0;
    for (const w of words) {
      measurer.textContent = w;
      const r = measurer.getBoundingClientRect();
      if (r.width  > maxW) maxW = r.width;
      if (r.height > maxH) maxH = r.height;
    }
    document.body.removeChild(measurer);

    // Fix the flip box size so sentence doesn't shift
    const vBuffer = 6;
    flip.style.width  = Math.ceil(maxW) + "px";
    flip.style.height = Math.ceil(maxH + vBuffer) + "px";

    // Build a word element centered vertically in 1em
    function makeWord(text){
      const el = document.createElement("span");
      el.className = "word";
      el.textContent = text;

      // temp measure to compute vertical nudge
      el.style.position = "absolute";
      el.style.visibility = "hidden";
      flip.appendChild(el);
      const h = el.getBoundingClientRect().height;
      flip.removeChild(el);
      el.style.position = ""; el.style.visibility = "";

      const linePx = parseFloat(getComputedStyle(flip).fontSize); // 1em in px
      const y = (linePx - h) / 2;
      el.style.setProperty("--y", y + "px");
      return el;
    }

    // Initial word
    let i = 0;
    let current = makeWord(words[i]);
    flip.appendChild(current);

    function cycle(){
      current.classList.remove("in");
      current.classList.add("out");

      setTimeout(() => {
        const nextIndex = (i + 1) % words.length;
        const next = makeWord(words[nextIndex]);
        next.classList.add("in");
        flip.appendChild(next);

        setTimeout(() => {
          if (current.parentNode === flip) flip.removeChild(current);
          current = next;
          i = nextIndex;
        }, inMs);
      }, outMs);
    }

    setInterval(cycle, interval);
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initFlip);
  } else {
    initFlip();
  }
})();
</script>
